CREATE DATABASE QLCHVLXD1
GO
use QLCHVLXD1
GO

CREATE TABLE KHACHHANG
(
	MAKH VARCHAR(15) PRIMARY KEY,
	TENKH NVARCHAR(50),
	DIACHI NVARCHAR(50),
	SDT NVARCHAR(12)
)
GO
CREATE TABLE NHACUNGCAP
(
	MANCC VARCHAR(15) PRIMARY KEY,
	TENNCC NVARCHAR(50),
	DIACHI NVARCHAR(50),
	SDT NVARCHAR(12)
)
GO

CREATE TABLE LOAIHANG
(
	MALOAI VARCHAR(15) PRIMARY KEY,
	TENLOAI NVARCHAR(50),
	DIENGIAI NVARCHAR(50),
	TRANGTHAI NVARCHAR(50)
)
GO

CREATE TABLE HANGHOA
(
	MAHH VARCHAR(15) PRIMARY KEY,
	MALOAI VARCHAR(15),
	TENHH NVARCHAR(50),
	DONVITINH NVARCHAR(50),
	XUATXU NVARCHAR(50),
	FOREIGN KEY(MALOAI) REFERENCES LOAIHANG(MALOAI)
)
GO 

CREATE TABLE NHANVIEN
(
	MANV VARCHAR(15) PRIMARY KEY,
	TENNV NVARCHAR(50),
	GIOITINH NVARCHAR(5),
	NGAYSINH DATETIME,
	DIACHI NVARCHAR(50),
	SDT NVARCHAR(12),
	DIENGIAI NVARCHAR(50),
	FLAG INT
)
GO

CREATE TABLE KHO
(
	IDKHO INT PRIMARY KEY,
	MAHH VARCHAR(15),
	SOLUONG INT
	FOREIGN KEY(MAHH) REFERENCES HANGHOA(MAHH)
)
GO
 CREATE TABLE TAIKHOAN
 (
	TEN VARCHAR(30) not null primary key,
	MATKHAU VARCHAR(50),
	QUYEN TINYINT
 )
 GO

CREATE TABLE TBLNGUOIDUNG_NHANVIEN
(
	ID_I INT PRIMARY KEY,
	TEN VARCHAR(30),
	MANV VARCHAR(15),
	FOREIGN KEY(TEN) REFERENCES TAIKHOAN(TEN),
	FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)
GO

CREATE TABLE HOADON_NHAP
(
	SO_HD_NHAP VARCHAR(15) PRIMARY KEY,
	MANCC VARCHAR(15),
	MANV VARCHAR(15),
	NGAYLAP_NHAP DATETIME,
	FLAGNHAP INT,
	FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC),
	FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)
GO
CREATE TABLE CT_HOADON_NHAP
(
	ID INT PRIMARY KEY,
	MAHH VARCHAR(15),
	SO_HD_NHAP VARCHAR(15),
	SOLUONG_NHAP INT,
	DONGIA_NHAP INT,
	FOREIGN KEY(MAHH) REFERENCES HANGHOA(MAHH),
	FOREIGN KEY(SO_HD_NHAP) REFERENCES HOADON_NHAP(SO_HD_NHAP)
)
GO

CREATE TABLE HOADON_XUAT
(
	SO_HD_XUAT VARCHAR(15) PRIMARY KEY,
	MAKH VARCHAR(15),
	MANV VARCHAR(15),
	NGAYLAP_XUAT DATETIME,
	FLAGXUAT INT,
	FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH),
	FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)
GO
CREATE TABLE CT_HOADON_XUAT
(
	IDXUAT INT PRIMARY KEY,
	IDKHO INT,
	SO_HD_XUAT VARCHAR(15),
	SOLUONG_XUAT INT,
	DONGIA_XUAT INT,
	FOREIGN KEY(IDKHO) REFERENCES KHO(IDKHO),
	FOREIGN KEY(SO_HD_XUAT) REFERENCES HOADON_XUAT(SO_HD_XUAT)
)
GO
INSERT INTO KHACHHANG VALUES
('KH0001',N'Nguyễn Hữu Nghị','Long Xuyên, An Giang','0333432344'),
('KH0002',N'Nguyễn Phạm Minh Hào','Long Xuyên, An Giang','033769344'),
('KH0003',N'Trương Triều Vĩ','Long Xuyên, An Giang','038993843'),
('KH0004',N'Lý Ngọc Thái Bảo','Long Xuyên, An Giang','033346464'),
('KH0005',N'Tommy Tèo','Long Xuyên, An Giang','099929292'),
('KH0006',N'Cristiano Ronaldo','Madeira, Portugal','082773729')
select * from KHACHHANG

INSERT INTO NHANVIEN VALUES
('NV0001',N'Lionel Messi','Nam','6/24/1987','Argentina','09837377',N'Nhân viên',1),
('NV0002',N'Lê Phạm Phương Vy',N'Nữ','4/27/2002',N'Tân Châu, An Giang','087373727',N'Nhân viên',1),
('NV0003',N'Phú Quang Tiến','Nam','7/10/2001',N'Tân Châu, An Giang','098548577',N'Nhân viên',1),
('NV0004',N'Nguyễn Công Phượng','Nam','6/6/1997',N'Nghệ An','093747377',N'Nhân viên',1),
('NV0005',N'Trấn Thành','Nam','6/24/1988',N'TPHCM','099292927',N'Nhân viên',1),
('NV0006',N'Harry Maguire','Nam','2/6/1994',N'Ơn Lạnh','09837377',N'Nhân viên',1)
select * from NHANVIEN


INSERT INTO LOAIHANG VALUES
('Ton',N'Tôn',N'Tôn gồm: Tôn lạnh, nóng','Còn kinh doanh'),
('Thep',N'Thép',N'Thép gồm: Tôn phi, cuộn','Còn kinh doanh'),
('Gach',N'Gạch',N'Gạch gồm: Gạch thẻ, ống, men','Còn kinh doanh'),
('Da',N'Đá',N'Đá gồm: Đá 1x2,2x3,4x6','Còn kinh doanh'),
('XM',N'Xi măng',N'Xi măng gồm: Xi măng PCB,xi măng Hà Tiên','Còn kinh doanh'),
('Nhom',N'Nhôm',N'Nhôm gồm: Nhôm thanh, nhôm uốn','Còn kinh doanh'),
('Cat',N'Cát',N'Cát gồm: Cát mịn, nền','Còn kinh doanh'),
('Kem',N'Kẽm',N'Kẽm gồm: Kẽm phi, cuộn ly','Còn kinh doanh')
select * from LOAIHANG

drop table HANGHOA

INSERT INTO HANGHOA VALUES
('TON01','Ton',N'Tôn lạnh',N'Tấm',N'Việt Nam'),
('TON02','Ton',N'Tôn nóng',N'Tấm',N'Việt Nam'),
('THEP01','Thep',N'Thép cuộn',N'Kg',N'Việt Nam'),
('THEP02','Thep',N'Thép phi',N'Cây',N'Việt Nam'),
('GACH01','Gach',N'Gạch ống',N'Viên',N'Việt Nam'),
('GACH02','Gach',N'Gạch thẻ',N'Viên',N'Việt Nam'),
('XM01','XM',N'Xi măng PCB',N'Bao',N'Việt Nam'),
('XM02','XM',N'Xi măng Hà Tiên',N'Bao',N'Việt Nam'),
('NHOM01','Nhom',N'Nhôm thanh',N'Cây',N'Việt Nam'),
('NHOM02','Nhom',N'Nhôm uốn',N'Cây',N'Việt Nam'),
('KEM01','Kem',N'Kẽm phi',N'Cây',N'Việt Nam'),
('KEM02','Kem',N'Kẽm cuộn ly',N'Tấm',N'Việt Nam'),
('CAT01','Cat',N'Cát mịn',N'Khối',N'Việt Nam'),
('CAT02','Cat',N'Cát nền',N'Khối',N'Việt Nam'),
('DA01','Da',N'Đá 1x2',N'Khối',N'Việt Nam'),
('DA02','Da',N'Đá 2x3',N'Khối',N'Việt Nam'),
('DA03','Da',N'Đá 4x6',N'Khối',N'Việt Nam')
select * from HANGHOA

INSERT INTO NHACUNGCAP VALUES
('NCC00001',N'Tôn Hoa Sen',N'TP.HCM','08321567'),
('NCC00002',N'Tôn Đông Á',N'TP.HCM','03678437'),
('NCC00003',N'Hòa Phát',N'Hà Nội','09772567'),
('NCC00004',N'Hưng Việt',N'TP.HCM','08375617'),
('NCC00005',N'Inax',N'Bình Dương','0296358776'),
('NCC00006',N'Thiên Việt',N'Bình Dương','03228567'),
('NCC00007',N'Asaba',N'Đồng Nai','098877621')

select * from NHACUNGCAP

INSERT INTO TAIKHOAN VALUES
('admin','123',1),
('user','123',2)
SELECT * FROM TAIKHOAN

INSERT INTO HOADON_XUAT VALUES
('HD00001','KH0003','NV0001','4/4/2021',1),
('HD00002','KH0002','NV0005','8/2/2021',1),
('HD00003','KH0002','NV0003','3/9/2021',1)
SELECT * FROM HOADON_XUAT

INSERT INTO HOADON_NHAP VALUES
('HDN0001','NCC00001','NV0003','9/27/2020',1),
('HDN0002','NCC00003','NV0006','3/5/2020',1),
('HDN0003','NCC00004','NV0004','5/12/2020',1),
('HDN0004','NCC00001','NV0005','2/25/2020',1)
SELECT * FROM CT_HOADON_XUAT

SELECT * FROM NHANVIEN
INSERT INTO KHO VALUES
(1,'TON01',14000),
(2,'TON02',10000),
(3,'THEP01',10000),
(4,'THEP02',15000),
(5,'GACH01',50000),
(6,'GACH02',50000),
(7,'DA01',40000),
(8,'DA02',40000),
(9,'XM01',10000),
(10,'XM02',9000),
(11,'NHOM01',10000),
(12,'NHOM02',11000),
(13,'CAT01',15000),
(14,'CAT02',20000),
(15,'KEM01',9000),
(16,'KEM02',10000)

INSERT INTO CT_HOADON_XUAT VALUES
(1,1,'HD00001',200,130000),
(2,3,'HD00003',300,200000)

SELECT * FROM CT_HOADON_XUAT
SELECT c.SO_HD_XUAT,c.SOLUONG_XUAT,c.DONGIA_XUAT,k.TENKH,k.SDT,h.TENHH,n.TENNV,n.DIACHI,v.SOLUONG,m.NGAYLAP_XUAT from CT_HOADON_XUAT c,KHACHHANG k,NHANVIEN n,KHO v,HOADON_XUAT m,HANGHOA h where c.SO_HD_XUAT=m.SO_HD_XUAT and m.MAKH=k.MAKH and m.MANV=n.MANV and v.MAHH=h.MAHH and c.IDKHO=v.IDKHO
select * from Nhanvien

CREATE FUNCTION XEM_TENNV(@MANV NVARCHAR(10))
RETURNS NVARCHAR(50)
AS
	BEGIN
		DECLARE @MN NVARCHAR(50)
		SET @MN=(SELECT TENNV FROM NHANVIEN  where MANV LIKE '%'+@MANV+'%' )
		RETURN @MN
END
DROP FUNCTION XEM_TENNV
SELECT DBO.XEM_TENNV('NV0002');

select n.SO_HD_NHAP,n.MANCC,n.MANV,n.NGAYLAP_NHAP,m.TENNCC,v.TENNV from HOADON_NHAP n, NHACUNGCAP m, NHANVIEN v where n.MANCC=m.MANCC and n.MANV=v.MANV
select * from nhacungcap
private string LoaiHang;
        private string TenHang;
        private string DVT;
        private int SoLuongKho;
        private string XuatXu;
        private string MaHH;
        private int IDKho;
SELECT h.TENHH,h.DONVITINH,h.XUATXU,k.SOLUONG from HANGHOA h, KHO k where h.MAHH=k.MAHH
drop table LOAIHANG1
select * from KHO



